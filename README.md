<p align="center"><svg width="130" height="36" viewBox="0 0 130 36" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M7.30827 18C7.30827 16.7819 7.44361 15.6992 7.84962 14.6165L1.89474 10.015C0.676692 12.4511 0 15.1579 0 18C0 20.8421 0.676692 23.5489 1.89474 25.985L7.98496 21.3835C7.57895 20.3007 7.30827 19.218 7.30827 18Z" fill="#FBBC05"/>
<path d="M18 7.30827C20.5714 7.30827 22.8722 8.25564 24.6316 9.74436L29.9098 4.46617C26.6616 1.7594 22.6015 0 18 0C10.827 0 4.73682 4.06015 1.89471 10.015L7.98494 14.6165C9.33832 10.4211 13.2631 7.30827 18 7.30827Z" fill="#EA4335"/>
<path d="M18 28.6917C13.2632 28.6917 9.33835 25.579 7.84962 21.3835L1.7594 25.985C4.73684 31.9399 10.8271 36 17.8647 36C22.1955 36 26.391 34.3759 29.6391 31.5338L23.9549 27.0677C22.3308 28.1504 20.3008 28.6917 18 28.6917Z" fill="#34A853"/>
<path d="M18 14.7519V21.6541H27.609C27.0677 24.0902 25.8496 25.8496 23.9549 27.0677L29.6391 31.5338C32.8872 28.4211 35.0526 23.8195 35.0526 18C35.0526 16.9173 34.9173 15.8346 34.6466 14.7519H18Z" fill="#4285F4"/>
<path d="M62.8516 17.8477H67.6094V19.8984H62.8516V25.2891H60.6719V19.8984H55.9141V17.8477H60.6719V12.8672H62.8516V17.8477Z" fill="black"/>
<path d="M129.425 18.0041C129.425 15.3262 126.071 12.7883 120.93 11.2145C122.116 5.97391 121.589 1.80453 119.265 0.469672C118.729 0.156557 118.103 0.00823975 117.419 0.00823975V1.84573C117.798 1.84573 118.103 1.91989 118.359 2.05997C119.479 2.70268 119.965 5.14992 119.586 8.29755C119.496 9.0721 119.347 9.88785 119.166 10.7201C117.551 10.3246 115.788 10.0197 113.934 9.82193C112.821 8.29755 111.668 6.91325 110.506 5.70199C113.192 3.20531 115.714 1.83749 117.428 1.83749V0C115.162 0 112.195 1.61502 109.196 4.41657C106.197 1.6315 103.23 0.0329596 100.964 0.0329596V1.87045C102.67 1.87045 105.2 3.23003 107.886 5.71023C106.732 6.92149 105.579 8.29755 104.483 9.82193C102.621 10.0197 100.857 10.3246 99.2422 10.7283C99.0526 9.90433 98.9126 9.10506 98.8137 8.33875C98.4264 5.19112 98.9043 2.74388 100.017 2.09293C100.264 1.94461 100.585 1.87869 100.964 1.87869V0.0411994C100.272 0.0411994 99.6459 0.189517 99.1021 0.502632C96.7867 1.83749 96.2676 5.99863 97.4623 11.2227C92.3371 12.8048 89 15.3344 89 18.0041C89 20.6821 92.3536 23.22 97.4953 24.7938C96.3088 30.0343 96.8361 34.2037 99.1598 35.5386C99.6954 35.8517 100.322 36 101.014 36C103.28 36 106.246 34.385 109.245 31.5834C112.245 34.3685 115.211 35.967 117.477 35.967C118.169 35.967 118.795 35.8187 119.339 35.5056C121.655 34.1707 122.174 30.0096 120.979 24.7855C126.088 23.2117 129.425 20.6738 129.425 18.0041ZM118.696 12.5081C118.392 13.5711 118.013 14.667 117.584 15.7629C117.246 15.1037 116.892 14.4445 116.505 13.7853C116.126 13.1261 115.722 12.4834 115.318 11.8572C116.488 12.0302 117.617 12.2444 118.696 12.5081ZM114.923 21.2836C114.28 22.396 113.621 23.4507 112.937 24.4312C111.709 24.5383 110.465 24.596 109.212 24.596C107.968 24.596 106.724 24.5383 105.504 24.4395C104.821 23.4589 104.153 22.4125 103.51 21.3083C102.884 20.2289 102.316 19.133 101.797 18.0288C102.307 16.9247 102.884 15.8206 103.502 14.7411C104.145 13.6287 104.804 12.574 105.488 11.5935C106.716 11.4864 107.96 11.4287 109.212 11.4287C110.457 11.4287 111.701 11.4864 112.92 11.5853C113.604 12.5658 114.272 13.6123 114.914 14.7164C115.541 15.7958 116.109 16.8917 116.628 17.9959C116.109 19.1 115.541 20.2042 114.923 21.2836ZM117.584 20.2124C118.029 21.3165 118.408 22.4207 118.721 23.4919C117.642 23.7555 116.505 23.978 115.326 24.1511C115.73 23.5166 116.134 22.8656 116.513 22.1982C116.892 21.539 117.246 20.8716 117.584 20.2124ZM109.229 29.0043C108.463 28.2133 107.696 27.3317 106.938 26.3676C107.68 26.4005 108.438 26.4253 109.204 26.4253C109.979 26.4253 110.745 26.4088 111.495 26.3676C110.753 27.3317 109.987 28.2133 109.229 29.0043ZM103.098 24.1511C101.928 23.978 100.799 23.7638 99.7201 23.5001C100.025 22.4372 100.404 21.3413 100.832 20.2454C101.17 20.9046 101.525 21.5637 101.912 22.2229C102.299 22.8821 102.695 23.5248 103.098 24.1511ZM109.188 7.00389C109.954 7.79492 110.72 8.67658 111.478 9.64065C110.737 9.60769 109.979 9.58297 109.212 9.58297C108.438 9.58297 107.672 9.59945 106.922 9.64065C107.663 8.67658 108.43 7.79492 109.188 7.00389ZM103.09 11.8572C102.686 12.4916 102.283 13.1426 101.904 13.81C101.525 14.4692 101.17 15.1284 100.832 15.7876C100.388 14.6835 100.008 13.5793 99.6954 12.5081C100.775 12.2527 101.912 12.0302 103.09 11.8572ZM95.6331 22.1735C92.7162 20.9293 90.8293 19.2978 90.8293 18.0041C90.8293 16.7105 92.7162 15.0707 95.6331 13.8347C96.3417 13.5299 97.1163 13.258 97.9155 13.0025C98.3852 14.6175 99.0032 16.2985 99.7695 18.0206C99.0114 19.7345 98.4017 21.4072 97.9403 23.014C97.1245 22.7585 96.35 22.4784 95.6331 22.1735ZM100.066 33.9483C98.9455 33.3056 98.4594 30.8583 98.8384 27.7107C98.929 26.9361 99.0774 26.1204 99.2586 25.2882C100.874 25.6837 102.637 25.9886 104.491 26.1863C105.603 27.7107 106.757 29.095 107.919 30.3062C105.233 32.8029 102.711 34.1707 100.997 34.1707C100.626 34.1625 100.313 34.0883 100.066 33.9483ZM119.611 27.6695C119.998 30.8171 119.52 33.2644 118.408 33.9153C118.161 34.0636 117.84 34.1295 117.461 34.1295C115.755 34.1295 113.225 32.77 110.539 30.2898C111.693 29.0785 112.846 27.7024 113.942 26.1781C115.804 25.9803 117.568 25.6754 119.183 25.2717C119.372 26.1039 119.52 26.9032 119.611 27.6695ZM122.783 22.1735C122.075 22.4784 121.3 22.7503 120.501 23.0057C120.031 21.3907 119.413 19.7098 118.647 17.9876C119.405 16.2737 120.015 14.6011 120.476 12.9943C121.292 13.2497 122.067 13.5299 122.792 13.8347C125.709 15.079 127.596 16.7105 127.596 18.0041C127.587 19.2978 125.7 20.9375 122.783 22.1735Z" fill="#61DAFB"/>
<path d="M109.204 21.7698C111.284 21.7698 112.97 20.0838 112.97 18.0041C112.97 15.9244 111.284 14.2385 109.204 14.2385C107.124 14.2385 105.439 15.9244 105.439 18.0041C105.439 20.0838 107.124 21.7698 109.204 21.7698Z" fill="#61DAFB"/>
</svg>
</p>

<h1 align="center">react-use-googlelogin</h1>

[![NPM](https://img.shields.io/npm/v/react-use-googlelogin.svg?&color=green)](https://www.npmjs.com/package/react-use-googlelogin)
![npm bundle size](https://img.shields.io/bundlephobia/minzip/react-use-googlelogin.svg?logoColor=brightgreen)

Use
[Google's oAuth2](https://developers.google.com/identity/protocols/OAuth2UserAgent)
with React! This is a small wrapper over Google's oAuth2 JavaScript client
library for accessing Google login functionality in your React app.

You can find a demo here on [Code Sandbox](https://codesandbox.com). _TODO_

## Install

```bash
# npm
npm install --save react-use-googlelogin

# yarn
yarn add react-use-googlelogin
```

## Usage

âš  **Important**: You will need to have an active application and `clientID` from
Google's developer console.
[Refer to "before you begin" for more information](https://developers.google.com/identity/sign-in/web/sign-in)
on creating a `clientID` for your application.

### Sample Using Context

```jsx
import React from 'react'
import { useGoogleLogin } from 'react-use-googlelogin'

const GoogleAuthContext = React.createContext() // Not necessary, but recommended.

export const GoogleAuthProvider = ({ children }) => {
  const googleAuth = useGoogleLogin({
    clientId: process.env.GOOGLE_CLIENT_ID, // Your clientID from Google.
  })

  return (
    <GoogleAuthContext.Provider value={googleAuth}>
      {/* The rest of your app */}
      {children}
    </GoogleAuthContext.Provider>
  )
}

export const useGoogleAuth = () => React.useContext(GoogleAuthContext)

// In another component...
const GoogleLoginButton = () => {
  const { signIn } = useGoogleAuth()

  const handleSignIn = async () => {
    await signIn()
  }

  return <button onClick={handleSignIn}>Sign in with Google</button>
}
```

**As a React Hook**, you can destructure these values:

- `googleUser`
- `signIn`
- `signOut`
- `isLoggedIn`

### googleUser

A `GoogleAuth` instance representing the logged in user. Contains the user's
verifiable ID token in the `id_token` key. Refer to
[Google's docs](https://developers.google.com/identity/sign-in/web/backend-auth)
on verifying ID tokens on your backend.

Contains basic user information within the `profileObj` key.

If no user is logged in, this value is `null`.

```jsx
const Profile = () => {
  const { googleUser } = useGoogleLogin()

  return (
    <div>
      <h1>{googleUser.profileObj.name}</h1>
      <p>{googleUser.profileObj.email}</p>
      <img src={googleUser.profileObj.imageUrl} />
    </div>
  )
}
```

This object is the same raw `GoogleAuth` object returned by
`gapi.auth2.getAuthInstance()`. Use this object with the appropriate Google API
functions to fetch other data from the user's Google profile.

> `GoogleAuth` is a singleton class that allows you to get additional specific
> data from a user's Google profile and request for additional scopes if they
> are under the scopes specified in your developer console.

Refer to
[Google's docs](https://developers.google.com/identity/sign-in/web/reference#authentication)
for more info.

### signIn()

A function that will prompt the user to login via Google. Will use the sign-in
flow specified by the `uxMode` parameter.

On success, this function returns `googleUser`. This is useful if immediate
access to `googleUser` is needed following a sign in. We would otherwise need to
wait for a re-render to see the hook value updated.

If the sign in flow fails for any reason, `signIn()` returns `false`.

```jsx
const GoogleLoginButton = () => {
  const { signIn } = useGoogleLogin()

  const handleSignIn = async () => {
    const googleUser = await signIn() // if you need immediate access to `googleUser`, get it from signIn() instead of waiting for a re-render.
  }
}
```

### signOut()

Signs out the current user and disconnects the current oAuth2 client. Sets the
`googleUser` back to `null`.

### isLoggedIn

A boolean that is `true` when a user is actively logged in, and `false` when
otherwise.

```jsx
const Page = () => {
  const { isLoggedIn } = useGoogleLogin()

  return (
    <div>
      <h2>Some regular stuff</h2>
      {isLoggedIn && <p>We are logged in!</p>}
    </div>
  )
}
```

## API

Specify any of the options defined below:

```js
useGoogleLogin({
  clientId: String!,
  hostedDomain: String,
  discoveryDocs: Array,
  responseType: String,
  redirectUri: String,
  scope: String,
  accessType: String,
  cookiePolicy: String,
  fetchBasicProfile: Boolean,
  autoSignIn: String,
  uxMode: String
})
```

| Name              | Type    | Default              | Description                                                                                                                                                                                                                             |     |
| ----------------- | ------- | -------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| clientId          | String  | ---                  | **Required**. The clientID for your application from Google's developer console.                                                                                                                                                        |     |
| hostedDomain      | String  | ---                  | The G Suite domain to which users must belong to sign in. If blank, all google accounts can login.                                                                                                                                      |     |
| autoSignIn        | String  | 'none'               | Enum allowing either `none`, `prompt` or `auto`. If set to `prompt`, will attempt to automatically sign the user in with the full ux flow (popup, redirect). If set to `auto`, will attempt to automatically login without any ux flow. |     |
| discoveryDocs     | Array   | []                   | For info on discovery docs, refer to: https://developers.google.com/discovery/v1/using                                                                                                                                                  |     |
| redirectUri       | String  | ''                   | If `uxMode` is set to `redirect`, this is the address a user will be sent to after resolving the Google auth flow.                                                                                                                      |     |
| scope             | String  | 'profile email'      | The scopes to request, as a space-delimited string. Optional if `fetch_basic_profile` is set to true.                                                                                                                                   |     |
| accessType        | String  | 'online'             | An enum allowing either `online` or `offline`. If `offline` with `responseType` of `code`, the hook will return a refresh token in `googleUser`.                                                                                        |     |
| cookiePolicy      | String  | 'single_host_origin' | The domains for which to create sign-in cookies. Either a URI, `single_host_origin`, or none                                                                                                                                            |     |
| fetchBasicProfile | Boolean | true                 | Allows fetching of users' basic profile information when they sign in. Adds 'profile', 'email' and 'openid' to the requested scopes.                                                                                                    |     |
| uxMode            | String  | 'popup'              | Enum of either `popup` or `redirect`. If `redirect`, will redirect the user to the uri specified in `redirectUri` after login flow.                                                                                                     |     |

## Gotchas

### The user is lost if I refresh the page!

This is "intended". I didn't want to make any assumptions as to how developers
would want to persist user information, so it's left up to the developer to do
so.

The hook does provide a `autoSignIn` option that can automatically
re-authenticate a user when the app refreshes, but this may not provide the most
ideal UX for some use cases.

For a more seamless UX, a solution leveraging `localStorage` or cookies is
recommended.

## License

MIT.
